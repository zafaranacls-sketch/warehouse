<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø²Ù†</title>
<style>
:root{
  --we-purple:#6c2d9b;
  --we-purple-dark:#4a1f6e;
  --card-bg: #fff;
  --muted:#666;
}
*{box-sizing:border-box}
body{font-family: Tahoma, Arial, sans-serif;background:#f6f6fb;margin:0;color:#222}
header{background:linear-gradient(90deg,var(--we-purple),var(--we-purple-dark));color:#fff;padding:18px 20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}
header h1{margin:0;font-size:18px}
.controls{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-top:10px}
.controls input{padding:8px;border-radius:6px;border:0;min-width:200px}
.controls button{padding:8px 10px;border-radius:6px;border:0;background:#fff;color:var(--we-purple);cursor:pointer}
main{padding:18px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}
.card{background:var(--card-bg);padding:14px;border-radius:12px;box-shadow:0 6px 18px rgba(28,20,40,0.06);border-left:6px solid var(--we-purple)}
.card h2{margin:0 0 8px 0}
.card p{margin:0;color:var(--muted)}
.rack-card{cursor:pointer}
.box-list{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
.box{background:#f2f2f9;padding:6px 10px;border-radius:8px;font-size:13px}
.box .meta{font-size:11px;color:var(--muted);display:block}
.actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
.actions button{padding:6px 8px;border-radius:8px;border:0;background:var(--we-purple);color:#fff;cursor:pointer}
.small{padding:6px 8px;font-size:12px}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center}
.modal.hidden{display:none}
.modal-inner{background:#fff;padding:18px;border-radius:12px;width:320px}
.modal-inner label{display:block;margin-bottom:8px}
.modal-inner input, .modal-inner select{width:100%;padding:8px;margin-top:6px;border-radius:6px;border:1px solid #ddd}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
</style>
</head>
<body>
<header>
  <h1>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø²Ù†</h1>
  <div class="controls">
    <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù€Ù… Ø§Ù„Ø¨ÙˆÙƒØ³ Ø£Ùˆ Ù†ÙˆØ¹Ù‡..." />
    <button id="searchBtn">ğŸ” Ø¨Ø­Ø«</button>
    <button id="addBtn">â• Ø¥Ø¶Ø§ÙØ© Box</button>
    <button id="backBtn" style="display:none">â† Ø±Ø¬ÙˆØ¹</button>
  </div>
</header>

<main id="app"></main>

<div id="modal" class="modal hidden">
  <div class="modal-inner">
    <h3>Ø¥Ø¶Ø§ÙØ© Box Ø¬Ø¯ÙŠØ¯</h3>
    <label>Ø§Ù„Ù…Ø®Ø²Ù†<select id="modalStore"></select></label>
    <label>Ø§Ù„Ø±Ø§Ùƒ<select id="modalRack"></select></label>
    <label>Ø§Ù„Ø´ÙŠÙ„Ù<select id="modalShelf"></select></label>
    <label>Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙƒØ³<input id="modalBoxId" /></label>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙˆÙƒØ³<input id="modalBoxType" /></label>
    <div class="modal-actions">
      <button id="modalSave">Ø­ÙØ¸</button>
      <button id="modalCancel">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<script>
  const API_URL =
    "https://script.google.com/macros/s/AKfycbwm3ijQv2LDTQ2OzonjAvZJaMBwAYOaGzTWqRQMUoT59pouGv1Jk8JwiwmbiPL5m_5R/exec";
// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø²Ù† (Ø§Ù„Ù…Ø®Ø²Ù† 1 ÙØ¹Ù„ÙŠ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ ÙØ§Ø¶ÙŠ)
const STORE_DATA = [
  {name:'Ø§Ù„Ù…Ø®Ø²Ù† 1', racks:[
    {id:'Rack 1', label:'TE-MESH', shelves:[
      {id:'SH1', boxes:['46','44','45','41','43','32','30','49','20','18','57','26','52','50','24','53','42','27','29','51','17','47','40','19','16','78','72','76','77','8','23','48','21','55','56','58','59','60','64','65','66','70']},
      {id:'SH2', boxes:['14','12','11','13','3','6','4','2','5','10','9','1']},
      {id:'SH3', boxes:['22','36','35','73','74','75','37','67','68','31']}
    ]},
    {id:'Rack 2', label:'GBI & AAE-1 & SEACOME', shelves:[
      {id:'SH1', note:'GBI NOKIA', boxes:['28','9','20','18','19','17','18-2','21','20-2','5','25','27','22','6','4','11','15','3','2','1','14','15-2','16','24','7','8']},
      {id:'SH2', note:'AAE-1 UPG2 FILLERS, CIENA', boxes:[]},
      {id:'SH3', note:'PFE conv AAE1 & Filters', boxes:[]}
    ]},
    {id:'Rack 3', label:'SMW5', shelves:[
      {id:'SH1', boxes:['45','59','25','24','46','17','18','19','22','20','21','14','10','9','8','13','12','11','16','3','7','4','2','5','61']},
      {id:'SH2', boxes:['36','37','38','39','40','41','34','35','29','58','55','53','52','51','50','44','48','54','57','31']},
      {id:'SH3', boxes:['1','2','3','4','5','6','7','8','9','10','11','12']}
    ]},
    {id:'Rack 4', label:'EIG & AAE-1', shelves:[
      {id:'SH1', note:'EIG', boxes:['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','32','33','34','30','31','35','36','37','38','39','40','41','42','43','44','45','46','47','48','49','50','51','52','53','54']},
      {id:'SH2', note:'EIG continued', boxes:['54','55','56','57','58','59','60','61','62','63','64','65','66','67','68','69','70']},
      {id:'SH3', note:'AAE-1', boxes:['1','2','4','4-fiber-scope']}
    ]},
    {id:'Rack 5', label:'TATA', shelves:[
      {id:'SH1', boxes:['1','2','3','4','6','9','10']},
      {id:'SH2', boxes:['5','7','8']},
      {id:'SH3', boxes:['11','14']},
      {id:'SH4', boxes:['12','15']},
      {id:'SH5', boxes:['24','25','26']}
    ]}
  ]},
  {"name":"Ø§Ù„Ù…Ø®Ø²Ù† 2","racks":[{"id":"Rack 1","label":"FIBER","shelves":[{"id":"SH1","note":"UN USED PATCH","boxes":[]},{"id":"SH2","note":"LOOPS, SC/SC APC, SC/FC, LC/FC, SC APC/FC","boxes":[]},{"id":"SH3","note":"FC/FC, LC/SCAPC, SC/SC, SC APC/SC APC","boxes":[]},{"id":"SH4","note":"LC/LC, SC/LC","boxes":[]}]},{"id":"Rack 2","label":"SEACOME JOINTS & EIG JOINTS & AAE-1 & SMW5","shelves":[{"id":"SH1","note":"-","boxes":[]},{"id":"SH2","note":"SEACOME JOINTS","boxes":[]},{"id":"SH3","note":"EIG JOINTS, AAE-1 JOINTS, BOX HAVE POWER CABLE","boxes":[]},{"id":"SH4","note":"SMW5 JOINTS","boxes":[]}]},{"id":"Rack 3","label":"TE-PEASE","shelves":[{"id":"SH1","note":"-","boxes":[]},{"id":"SH2","note":"-","boxes":[]},{"id":"SH3","note":"3 BOXES TE-PEASE FIBER","boxes":["TE-PEASE-1","TE-PEASE-2","TE-PEASE-3"]},{"id":"SH4","note":"-","boxes":[]}]}]},
  {"name":"Ø§Ù„Ù…Ø®Ø²Ù† 3","racks":[{"id":"Rack 1","label":"GBI INFINIRA & UPG SMW5","shelves":[{"id":"SH1","note":"UPG SMW5","boxes":[]},{"id":"SH2","note":"GBI INFINIRA","boxes":["1","3","4","5","6","7","8","9","10","12","13","14","15","16","17","18","19","20","21","23","24","26","27","28","29","33","34","35"]},{"id":"SH3","note":"GBI INFINIRA","boxes":["2","11","36","37","25","22","44","45","46","47","50","41","42","48","49","30","38","39","40","32","43","31"]},{"id":"SH4","note":"GBI INFINIRA & SEACOME (POWER STAGE...)","boxes":["POWER-STAGE-1","1","2","3","5","7","6"]}]},{"id":"Rack 2","label":"UPG SMW5 & 2-AFRICA DEVICE","shelves":[{"id":"SH1","note":"UPG SMW5","boxes":[]},{"id":"SH2","note":"UPG SMW5","boxes":[]},{"id":"SH3","note":"UPG SMW5","boxes":[]},{"id":"SH4","note":"2-AFRICA DEVICE (ELECTRODING GENERATOR)","boxes":[]}]},{"id":"Rack 3","label":"TE-PEASE & EIG PFE & EIG DEVICES","shelves":[{"id":"SH1","boxes":["18/2","19"]},{"id":"SH2","note":"TE-PEASE","boxes":["1","2","3","4","5","6","7","8","9","10","12","13","14","15","16","17"]},{"id":"SH3","note":"EIG PFE","boxes":["1","2","3","4","5","6","7","8","9","10","11","12","15","16","17","18","19","20","21","22","23","24","25","27","28","29","30","31","32","33","35","36","37","38","39","40","41"]},{"id":"SH4","note":"EIG DEVICES & OTDR/OSA etc","boxes":["BOX-11","EIG-OTDR","EIG-OSA","EIG-TINSLY","EIG-POWER-METER","EIG-DTA","EIG-FUSION-SPLUKER","EIG-PFE"]}]},{"id":"Rack 4","label":"WE-CONNECT & MATERIAL","shelves":[{"id":"SH1","note":"","boxes":[]},{"id":"SH2","note":"WE-CONNECT","boxes":[]},{"id":"SH3","note":"CABLES, ROT MATERIAL","boxes":[]},{"id":"SH4","note":"CABLES, FIBER RUNNER","boxes":[]}]},{"id":"Rack 5","label":"WE-CONNECT","shelves":[{"id":"SH1","note":"WE-CONNECT","boxes":[]},{"id":"SH2","note":"WE-CONNECT","boxes":[]},{"id":"SH3","note":"WE-CONNECT","boxes":[]},{"id":"SH4","note":"WE-CONNECT","boxes":[]},{"id":"SH5","note":"WE-CONNECT","boxes":[]}]}]},
  {"name":"Ø§Ù„Ù…Ø®Ø²Ù† 4","racks":[{"id":"Rack 1","label":"SEACOME","shelves":[{"id":"SH1","note":"","boxes":[]},{"id":"SH2","note":"SEACOME TYCO","boxes":["15","16","17","18","7","14","1","2","3"]},{"id":"SH3","note":"SEACOME CIENA","boxes":["2","3","6","9","11","13","15","16","17","18","19","21","22","23","26","30","31","33","34","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","59","35"]},{"id":"SH4","note":"SEACOME PFE","boxes":["1","2","3","4","5","6","7","8","9","11","12","13"]}]},{"id":"Rack 2","label":"TATA & EIG ALCATEL & IN/OUT UNKNOWN STOCK","shelves":[{"id":"SH1","note":"EMPTY BOXES FOR TATA, 3 FIBER BOXES","boxes":[]},{"id":"SH2","note":"EIG ALCATEL CHASSIS","boxes":[]},{"id":"SH3","note":"FILLER","boxes":[]},{"id":"SH4","note":"IN/OUT UNKNOWN STOCK","boxes":[]}]},{"id":"Rack 3","label":"EMPTY BOXES & EITHER CABLES","shelves":[{"id":"SH1","note":"","boxes":[]},{"id":"SH2","note":"EMPTY BOXES","boxes":[]},{"id":"SH3","note":"EMPTY BOXES, EBOX HAVE EITHER CABLES","boxes":[]},{"id":"SH4","note":"EMPTY BOXES","boxes":[]}]},{"id":"Rack 4","label":"FIBER & EIG ALCATEL FAULTY CARDS & FILLER & GBI ROT MATERIAL","shelves":[{"id":"SH1","note":"6 FIBER BOXES, EMPTY BOXES","boxes":[]},{"id":"SH2","note":"4 FIBER BOXES","boxes":[]},{"id":"SH3","note":"EMPTY BOXES","boxes":[]},{"id":"SH4","note":"EIG ALCATEL FAULTY CARDS & FILLER & GBI ROT MATERIAL","boxes":[]}]}]}
];

const app=document.getElementById('app'),searchInput=document.getElementById('searchInput'),searchBtn=document.getElementById('searchBtn'),addBtn=document.getElementById('addBtn'),backBtn=document.getElementById('backBtn'),modal=document.getElementById('modal');
let state={stores:STORE_DATA,view:'stores',storeIndex:null,rackIndex:null};
// Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Google Sheet
async function apiAdd(row) { // row = {store,rack,shelf,box,type}
  const res = await fetch(API_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(row)
  });
  return await res.json();
}

async function apiList() {
  const res = await fetch(API_URL + "?action=list");
  return await res.json();
}

async function load() {
  try {
    const rows = await apiList();
    console.log("Data loaded:", rows);

    const storesMap = {};
    // ØªØ£ÙƒØ¯ Ø¥Ù† rows Ù…ÙˆØ¬ÙˆØ¯Ø© ÙˆÙ…ÙÙŠÙ‡Ø§Ø´ Ø®Ø·Ø£
    if (!Array.isArray(rows)) {
      console.error("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©:", rows);
      return;
    }

    rows.slice(1).forEach(r => { // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ (Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©)
      const st = r[1] || "Ø§Ù„Ù…Ø®Ø²Ù† 1";
      const rack = r[2] || "Rack 1";
      const shelf = r[3] || "SH1";
      const box = r[4] || "";
      const type = r[5] || "";

      if (!storesMap[st]) storesMap[st] = { name: st, racks: [] };

      let rk = storesMap[st].racks.find(x => x.id === rack);
      if (!rk) {
        rk = { id: rack, label: "", shelves: [] };
        storesMap[st].racks.push(rk);
      }

      let sh = rk.shelves.find(x => x.id === shelf);
      if (!sh) {
        sh = { id: shelf, boxes: [] };
        rk.shelves.push(sh);
      }

      // âœ… Ù‡Ù†Ø§ ÙƒØ§Ù† Ø§Ù„Ø®Ø·Ø£ .. Ù„Ø§Ø²Ù… Ù†Ø³ØªØ®Ø¯Ù… backticks ``
      sh.boxes.push(${box} (${type}));
    });

    state.stores = Object.values(storesMap);
    renderStores();

  } catch (err) {
    console.error("Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", err);
  }
}

function save() {
  // Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… localStorage Ø¨Ø¹Ø¯ Ø§Ù„Ø¢Ù†
}

async function init() {
  await load();
}
function clearMain(){app.innerHTML='';}
function renderStores(){state.view='stores';backBtn.style.display='none';clearMain();const grid=document.createElement('div');grid.className='grid';state.stores.forEach((st,i)=>{const card=document.createElement('div');card.className='card';card.innerHTML=`<h2>${st.name}</h2><p>Racks: ${st.racks.length}</p>`;card.addEventListener('click',()=>openStore(i));grid.appendChild(card);});app.appendChild(grid);}
function openStore(i){state.storeIndex=i;state.view='racks';backBtn.style.display='inline-block';renderRacks();}
function renderRacks(){clearMain();const st=state.stores[state.storeIndex];const grid=document.createElement('div');grid.className='grid';st.racks.forEach((rk,ri)=>{const card=document.createElement('div');card.className='card rack-card';card.innerHTML=`<h2>${rk.id}</h2><p>${rk.label||''}</p><div class="box-list">${rk.shelves.map(s=>`<span class="box">${s.id} (${s.boxes.length})</span>`).join('')}</div>`;card.addEventListener('click',()=>openRack(ri));grid.appendChild(card);});const actions=document.createElement('div');actions.className='actions';const addRack=document.createElement('button');addRack.textContent='â• Ø¥Ø¶Ø§ÙØ© Rack';addRack.className='small';addRack.onclick=()=>{const id=prompt('Ø§Ø³Ù… Ø§Ù„Rack Ù…Ø«Ù„Ø§Ù‹ Rack 6');if(!id)return;st.racks.push({id,label:'',shelves:[]});save();renderRacks();};actions.appendChild(addRack);app.appendChild(grid);app.appendChild(actions);}
function openRack(index){state.rackIndex=index;state.view='shelves';backBtn.style.display='inline-block';renderShelves();}
function renderShelves(){clearMain();const st=state.stores[state.storeIndex];const rk=st.racks[state.rackIndex];const container=document.createElement('div');container.innerHTML=`<h2>${st.name} â€º ${rk.id} <small style='color:#666;margin-right:8px'>${rk.label||''}</small></h2>`;rk.shelves.forEach((sh,si)=>{const card=document.createElement('div');card.className='card';const boxesHtml=(sh.boxes||[]).map(b=>`<div class='box'><strong>${b}</strong><span class='meta'>${sh.note||''}</span><div style='margin-top:6px'><button class='small' onclick='editBox(${si},"${b}")'>âœï¸</button> <button class='small' onclick='deleteBox(${si},"${b}")'>ğŸ—‘ï¸</button> <a class='small' target='_blank' href='https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=${encodeURIComponent(st.name+"|"+rk.id+"|"+sh.id+"|"+b)}'>QR</a></div></div>`).join('');card.innerHTML=`<h3>${sh.id}</h3><p>${sh.note||''}</p><div class='box-list'>${boxesHtml}</div>`;container.appendChild(card);});const controls=document.createElement('div');controls.className='actions';const addShelf=document.createElement('button');addShelf.textContent='â• Ø¥Ø¶Ø§ÙØ© Shelf';addShelf.onclick=()=>{const id=prompt('Ø§Ø³Ù… Ø§Ù„Shelf Ù…Ø«Ù„Ø§Ù‹ SH4');if(!id)return;rk.shelves.push({id,boxes:[]});save();renderShelves();};const addBox=document.createElement('button');addBox.textContent='â• Ø¥Ø¶Ø§ÙØ© Box';addBox.onclick=()=>openModalForAdd();controls.appendChild(addShelf);controls.appendChild(addBox);app.appendChild(container);app.appendChild(controls);}
function openModalForAdd(){modal.classList.remove('hidden');const sStore=document.getElementById('modalStore'),sRack=document.getElementById('modalRack'),sShelf=document.getElementById('modalShelf');sStore.innerHTML='';sRack.innerHTML='';sShelf.innerHTML='';state.stores.forEach((st,i)=>{const o=document.createElement('option');o.value=i;o.textContent=st.name;sStore.appendChild(o);});sStore.value=state.storeIndex??0;populateRacks();sStore.onchange=populateRacks;document.getElementById('modalBoxId').value='';document.getElementById('modalBoxType').value='';}
function populateRacks(){const sStore=document.getElementById('modalStore'),sRack=document.getElementById('modalRack'),sShelf=document.getElementById('modalShelf');const st=state.stores[+sStore.value];sRack.innerHTML='';sShelf.innerHTML='';st.racks.forEach((r,ri)=>{const o=document.createElement('option');o.value=ri;o.textContent=r.id;sRack.appendChild(o);});sRack.onchange=()=>{const r=st.racks[+sRack.value];sShelf.innerHTML='';r.shelves.forEach((sh,si)=>{const o=document.createElement('option');o.value=si;o.textContent=sh.id;sShelf.appendChild(o);});};if(sRack.options.length>0)sRack.onchange();}
document.getElementById('modalCancel').onclick=()=>{modal.classList.add('hidden');};
document.getElementById('modalSave').onclick=()=>{const si=+document.getElementById('modalStore').value,ri=+document.getElementById('modalRack').value,shi=+document.getElementById('modalShelf').value,boxId=document.getElementById('modalBoxId').value.trim(),boxType=document.getElementById('modalBoxType').value.trim();if(!boxId){alert('Ø§Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙƒØ³');return;}const st=state.stores[si];const shelf=st.racks[ri].shelves[shi];shelf.boxes.push(boxId);save();modal.classList.add('hidden');renderShelves();};
window.deleteBox=function(shIndex,boxId){const st=state.stores[state.storeIndex];const rk=st.racks[state.rackIndex];const shelf=rk.shelves[shIndex];if(!confirm('Ø§Ù…Ø³Ø­ Box '+boxId+' ØŸ'))return;const idx=shelf.boxes.indexOf(boxId);if(idx>-1)shelf.boxes.splice(idx,1);save();renderShelves();}
window.editBox=function(shIndex,boxId){const newVal=prompt('Ø¹Ø¯Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙƒØ³ Ø£Ùˆ Ù†ÙˆØ¹Ù‡',boxId);if(!newVal)return;const st=state.stores[state.storeIndex];const rk=st.racks[state.rackIndex];const shelf=rk.shelves[shIndex];const idx=shelf.boxes.indexOf(boxId);if(idx>-1)shelf.boxes[idx]=newVal;save();renderShelves();}
searchBtn.onclick=()=>{const q=(searchInput.value||'').trim();if(!q)return alert('Ø§ÙƒØªØ¨ Ø§Ù„Ù„ÙŠ Ù‡ØªØ¨Ø­Ø« Ø¹Ù†Ù‡');performSearch(q);}
function performSearch(q){const results=[];state.stores.forEach(st=>{st.racks.forEach(rk=>{rk.shelves.forEach(sh=>{(sh.boxes||[]).forEach(box=>{if(String(box).includes(q)||(sh.note||'').includes(q))results.push({store:st.name,rack:rk.id,shelf:sh.id,box});});});});});if(results.length===0){alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬');return;}clearMain();const out=document.createElement('div');out.innerHTML=`<h3>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« (${results.length})</h3>`;results.forEach(r=>{const c=document.createElement('div');c.className='card';c.innerHTML=`<strong>${r.box}</strong> â€” ${r.store} â€º ${r.rack} â€º ${r.shelf} <div><a target='_blank' href='https://chart.googleapis.com/chart?chs=150x150&cht=qr&chl=${encodeURIComponent(r.store+'|'+r.rack+'|'+r.shelf+'|'+r.box)}'>QR</a></div>`;out.appendChild(c);});app.appendChild(out);}
backBtn.onclick=()=>{if(state.view==='racks')renderStores();else if(state.view==='shelves')renderRacks();}
addBtn.onclick=()=>openModalForAdd();
init();
</script>
</body>
</html>
